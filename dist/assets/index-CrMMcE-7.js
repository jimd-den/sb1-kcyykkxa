var It=Object.defineProperty;var Tt=(s,e,t)=>e in s?It(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var X=(s,e,t)=>Tt(s,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function D(){}function _t(s){return s()}function et(){return Object.create(null)}function oe(s){s.forEach(_t)}function ht(s){return typeof s=="function"}function ue(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}let je;function me(s,e){return s===e?!0:(je||(je=document.createElement("a")),je.href=e,s===je.href)}function Ct(s){return Object.keys(s).length===0}function r(s,e){s.appendChild(e)}function E(s,e,t){s.insertBefore(e,t||null)}function v(s){s.parentNode&&s.parentNode.removeChild(s)}function vt(s,e){for(let t=0;t<s.length;t+=1)s[t]&&s[t].d(e)}function m(s){return document.createElement(s)}function I(s){return document.createTextNode(s)}function h(){return I(" ")}function B(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function f(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function bt(s){return s===""?null:+s}function Pt(s){return Array.from(s.childNodes)}function z(s,e){e=""+e,s.data!==e&&(s.data=e)}function Ee(s,e){s.value=e??""}function Ye(s,e,t,n){t==null?s.style.removeProperty(e):s.style.setProperty(e,t,"")}function ve(s,e,t){s.classList.toggle(e,!!t)}function Dt(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}let Pe;function Te(s){Pe=s}function He(){if(!Pe)throw new Error("Function called outside component initialization");return Pe}function De(s){He().$$.on_mount.push(s)}function yt(s){He().$$.on_destroy.push(s)}function ke(){const s=He();return(e,t,{cancelable:n=!1}={})=>{const i=s.$$.callbacks[e];if(i){const o=Dt(e,t,{cancelable:n});return i.slice().forEach(l=>{l.call(s,o)}),!o.defaultPrevented}return!0}}const ye=[],Ce=[];let we=[];const tt=[],Rt=Promise.resolve();let Ke=!1;function Nt(){Ke||(Ke=!0,Rt.then(Et))}function Je(s){we.push(s)}const qe=new Set;let be=0;function Et(){if(be!==0)return;const s=Pe;do{try{for(;be<ye.length;){const e=ye[be];be++,Te(e),Ot(e.$$)}}catch(e){throw ye.length=0,be=0,e}for(Te(null),ye.length=0,be=0;Ce.length;)Ce.pop()();for(let e=0;e<we.length;e+=1){const t=we[e];qe.has(t)||(qe.add(t),t())}we.length=0}while(ye.length);for(;tt.length;)tt.pop()();Ke=!1,qe.clear(),Te(s)}function Ot(s){if(s.fragment!==null){s.update(),oe(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(Je)}}function Ut(s){const e=[],t=[];we.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),we=e}const Me=new Set;let he;function Re(){he={r:0,c:[],p:he}}function Ne(){he.r||oe(he.c),he=he.p}function J(s,e){s&&s.i&&(Me.delete(s),s.i(e))}function Q(s,e,t,n){if(s&&s.o){if(Me.has(s))return;Me.add(s),he.c.push(()=>{Me.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}function ze(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function ae(s){s&&s.c()}function ne(s,e,t){const{fragment:n,after_update:i}=s.$$;n&&n.m(e,t),Je(()=>{const o=s.$$.on_mount.map(_t).filter(ht);s.$$.on_destroy?s.$$.on_destroy.push(...o):oe(o),s.$$.on_mount=[]}),i.forEach(Je)}function ie(s,e){const t=s.$$;t.fragment!==null&&(Ut(t.after_update),oe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function At(s,e){s.$$.dirty[0]===-1&&(ye.push(s),Nt(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function fe(s,e,t,n,i,o,l=null,c=[-1]){const u=Pe;Te(s);const a=s.$$={fragment:null,ctx:[],props:o,update:D,not_equal:i,bound:et(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:et(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};l&&l(a.root);let p=!1;if(a.ctx=t?t(s,e.props||{},(g,d,...S)=>{const _=S.length?S[0]:d;return a.ctx&&i(a.ctx[g],a.ctx[g]=_)&&(!a.skip_bound&&a.bound[g]&&a.bound[g](_),p&&At(s,g)),d}):[],a.update(),p=!0,oe(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){const g=Pt(e.target);a.fragment&&a.fragment.l(g),g.forEach(v)}else a.fragment&&a.fragment.c();e.intro&&J(s.$$.fragment),ne(s,e.target,e.anchor),Et()}Te(u)}class de{constructor(){X(this,"$$");X(this,"$$set")}$destroy(){ie(this,1),this.$destroy=D}$on(e,t){if(!ht(t))return D;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Ct(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const jt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(jt);var j=(s=>(s.IN_PROGRESS="IN_PROGRESS",s.PAUSED="PAUSED",s.ENDED="ENDED",s))(j||{}),Ve=(s=>(s.BEFORE="BEFORE",s.AFTER="AFTER",s))(Ve||{});class Lt{constructor(e,t,n,i,o){this.sessionRepository=e,this.commentRepository=t,this.pictureRepository=n,this.timeService=i,this.idGenerator=o}async startSession(e,t,n){if(!e||e.trim()==="")throw new Error("Session title cannot be empty");if(t<=0)throw new Error("Goal time must be greater than zero");const i=this.idGenerator.generate(),o=this.idGenerator.generate(),l={pictureId:o,sessionId:i,pictureData:n,pictureType:Ve.BEFORE};await this.pictureRepository.savePicture(l);const c={sessionId:i,title:e,goalTime:t,startTime:this.timeService.getCurrentTime(),beforePictureId:o,comments:[],sessionStatus:j.IN_PROGRESS};return await this.sessionRepository.saveSession(c),c}async addComment(e,t){const n=await this.sessionRepository.getSessionById(e);if(!n)throw new Error("Session not found");if(n.sessionStatus===j.ENDED)throw new Error("Cannot add comments to an ended session");const i={commentId:this.idGenerator.generate(),sessionId:e,timestamp:this.timeService.getCurrentTime(),text:t};return await this.commentRepository.saveComment(i),n.comments.push(i),await this.sessionRepository.updateSession(n),i}async pauseSession(e){const t=await this.sessionRepository.getSessionById(e);if(!t)throw new Error("Session not found");if(t.sessionStatus===j.ENDED)throw new Error("Cannot pause an ended session");return t.sessionStatus=j.PAUSED,await this.sessionRepository.updateSession(t),t}async resumeSession(e){const t=await this.sessionRepository.getSessionById(e);if(!t)throw new Error("Session not found");if(t.sessionStatus===j.ENDED)throw new Error("Cannot resume an ended session");return t.sessionStatus=j.IN_PROGRESS,await this.sessionRepository.updateSession(t),t}async endSession(e,t){const n=await this.sessionRepository.getSessionById(e);if(!n)throw new Error("Session not found");if(n.sessionStatus===j.ENDED)throw new Error("Session is already ended");const i=this.idGenerator.generate(),o={pictureId:i,sessionId:e,pictureData:t,pictureType:Ve.AFTER};return await this.pictureRepository.savePicture(o),n.afterPictureId=i,n.endTime=this.timeService.getCurrentTime(),n.sessionStatus=j.ENDED,await this.sessionRepository.updateSession(n),n}async getAllSessions(){return this.sessionRepository.getAllSessions()}async getSessionDetails(e){const t=await this.sessionRepository.getSessionById(e);if(!t)throw new Error("Session not found");return(!t.comments||t.comments.length===0)&&(t.comments=await this.commentRepository.getCommentsBySessionId(e)),t}async getPicture(e){return this.pictureRepository.getPictureById(e)}async deleteSession(e){const t=await this.sessionRepository.getSessionById(e);if(!t)throw new Error("Session not found");t.beforePictureId&&await this.pictureRepository.deletePicture(t.beforePictureId),t.afterPictureId&&await this.pictureRepository.deletePicture(t.afterPictureId);const n=await this.commentRepository.getCommentsBySessionId(e);for(const i of n)await this.commentRepository.deleteComment(i.commentId);await this.sessionRepository.deleteSession(e)}}class Mt{constructor(e){this.sessionUseCases=e}async startSession(e,t,n){return this.sessionUseCases.startSession(e,t,n)}async addComment(e,t){return this.sessionUseCases.addComment(e,t)}async pauseSession(e){return this.sessionUseCases.pauseSession(e)}async resumeSession(e){return this.sessionUseCases.resumeSession(e)}async endSession(e,t){return this.sessionUseCases.endSession(e,t)}async getAllSessions(){return this.sessionUseCases.getAllSessions()}async getSessionDetails(e){return this.sessionUseCases.getSessionDetails(e)}async getPicture(e){return this.sessionUseCases.getPicture(e)}async deleteSession(e){await this.sessionUseCases.deleteSession(e)}formatDuration(e,t){const i=(t||new Date).getTime()-e.getTime(),o=Math.floor(i/(1e3*60*60)),l=Math.floor(i%(1e3*60*60)/(1e3*60)),c=Math.floor(i%(1e3*60)/1e3);return`${o.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}:${c.toString().padStart(2,"0")}`}formatDate(e){return e.toLocaleString()}}class zt{constructor(){X(this,"SESSIONS_KEY","sessions")}async saveSession(e){const t=this.getSessions();t.push(e),localStorage.setItem(this.SESSIONS_KEY,JSON.stringify(t))}async getSessionById(e){const n=this.getSessions().find(i=>i.sessionId===e);return n?{...n,startTime:new Date(n.startTime),endTime:n.endTime?new Date(n.endTime):void 0,comments:n.comments.map(i=>({...i,timestamp:new Date(i.timestamp)}))}:null}async getAllSessions(){return this.getSessions().map(t=>({...t,startTime:new Date(t.startTime),endTime:t.endTime?new Date(t.endTime):void 0,comments:t.comments.map(n=>({...n,timestamp:new Date(n.timestamp)}))}))}async updateSession(e){const t=this.getSessions(),n=t.findIndex(i=>i.sessionId===e.sessionId);n!==-1&&(t[n]=e,localStorage.setItem(this.SESSIONS_KEY,JSON.stringify(t)))}async deleteSession(e){const n=this.getSessions().filter(i=>i.sessionId!==e);localStorage.setItem(this.SESSIONS_KEY,JSON.stringify(n))}getSessions(){const e=localStorage.getItem(this.SESSIONS_KEY);return e?JSON.parse(e):[]}}class Bt{constructor(){X(this,"COMMENTS_KEY","comments")}async saveComment(e){const t=this.getComments();t.push(e),localStorage.setItem(this.COMMENTS_KEY,JSON.stringify(t))}async getCommentsBySessionId(e){return this.getComments().filter(n=>n.sessionId===e).map(n=>({...n,timestamp:new Date(n.timestamp)}))}async deleteComment(e){const n=this.getComments().filter(i=>i.commentId!==e);localStorage.setItem(this.COMMENTS_KEY,JSON.stringify(n))}getComments(){const e=localStorage.getItem(this.COMMENTS_KEY);return e?JSON.parse(e):[]}}class Gt{constructor(){X(this,"PICTURES_KEY","pictures")}async savePicture(e){const t=this.getPictures();t.push(e),localStorage.setItem(this.PICTURES_KEY,JSON.stringify(t))}async getPictureById(e){return this.getPictures().find(n=>n.pictureId===e)||null}async deletePicture(e){const n=this.getPictures().filter(i=>i.pictureId!==e);localStorage.setItem(this.PICTURES_KEY,JSON.stringify(n))}getPictures(){const e=localStorage.getItem(this.PICTURES_KEY);return e?JSON.parse(e):[]}}let Le;const Ft=new Uint8Array(16);function qt(){if(!Le&&(Le=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Le))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Le(Ft)}const Z=[];for(let s=0;s<256;++s)Z.push((s+256).toString(16).slice(1));function Yt(s,e=0){return Z[s[e+0]]+Z[s[e+1]]+Z[s[e+2]]+Z[s[e+3]]+"-"+Z[s[e+4]]+Z[s[e+5]]+"-"+Z[s[e+6]]+Z[s[e+7]]+"-"+Z[s[e+8]]+Z[s[e+9]]+"-"+Z[s[e+10]]+Z[s[e+11]]+Z[s[e+12]]+Z[s[e+13]]+Z[s[e+14]]+Z[s[e+15]]}const Kt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),st={randomUUID:Kt};function Jt(s,e,t){if(st.randomUUID&&!s)return st.randomUUID();s=s||{};const n=s.random||(s.rng||qt)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Yt(n)}class Vt{getCurrentTime(){return new Date}}class Ht{generate(){return Jt()}}class Wt{constructor(){X(this,"videoElement",null);X(this,"stream",null)}async initialize(e){this.videoElement=e;try{this.stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}),this.videoElement&&(this.videoElement.srcObject=this.stream)}catch(t){throw console.error("Error accessing camera:",t),new Error("Could not access camera")}}takePicture(e){if(!this.videoElement||!this.stream)throw new Error("Camera not initialized");const t=e.getContext("2d");if(!t)throw new Error("Could not get canvas context");return e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight,t.drawImage(this.videoElement,0,0,e.width,e.height),e.toDataURL("image/jpeg")}stopCamera(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.videoElement&&(this.videoElement.srcObject=null)}}const _e=class _e{constructor(){X(this,"sessionRepository",new zt);X(this,"commentRepository",new Bt);X(this,"pictureRepository",new Gt);X(this,"timeService",new Vt);X(this,"idGenerator",new Ht);X(this,"cameraService",new Wt);X(this,"sessionUseCases",new Lt(this.sessionRepository,this.commentRepository,this.pictureRepository,this.timeService,this.idGenerator));X(this,"sessionService",new Mt(this.sessionUseCases))}static getInstance(){return _e.instance||(_e.instance=new _e),_e.instance}getSessionService(){return this.sessionService}getCameraService(){return this.cameraService}};X(_e,"instance");let pe=_e;function Qt(s){let e,t,n,i,o,l,c,u,a,p,g,d=s[5]&&nt(s),S=s[5]&&it(s);return{c(){d&&d.c(),e=h(),t=m("div"),S&&S.c(),n=h(),i=m("div"),o=m("label"),o.textContent="Upload Photo",l=h(),c=m("input"),u=h(),a=m("button"),a.textContent="Back",f(o,"for","fileUpload"),f(o,"class","upload-button svelte-2q4irt"),f(c,"id","fileUpload"),f(c,"type","file"),f(c,"accept","image/*"),f(c,"class","svelte-2q4irt"),f(i,"class","upload-control svelte-2q4irt"),f(a,"class","back-button svelte-2q4irt"),f(t,"class","camera-controls svelte-2q4irt")},m(_,b){d&&d.m(_,b),E(_,e,b),E(_,t,b),S&&S.m(t,null),r(t,n),r(t,i),r(i,o),r(i,l),r(i,c),s[17](c),r(t,u),r(t,a),p||(g=[B(c,"change",s[9]),B(a,"click",s[18])],p=!0)},p(_,b){_[5]?d?d.p(_,b):(d=nt(_),d.c(),d.m(e.parentNode,e)):d&&(d.d(1),d=null),_[5]?S?S.p(_,b):(S=it(_),S.c(),S.m(t,n)):S&&(S.d(1),S=null)},d(_){_&&(v(e),v(t)),d&&d.d(_),S&&S.d(),s[17](null),p=!1,oe(g)}}}function Xt(s){let e,t,n,i,o,l,c,u,a,p;return{c(){e=m("div"),t=m("p"),n=I(s[6]),i=h(),o=m("div"),l=m("button"),l.textContent="Retry Camera",c=h(),u=m("button"),u.textContent="Choose Different Option",f(o,"class","error-buttons svelte-2q4irt"),f(e,"class","camera-error svelte-2q4irt")},m(g,d){E(g,e,d),r(e,t),r(t,n),r(e,i),r(e,o),r(o,l),r(o,c),r(o,u),a||(p=[B(l,"click",s[7]),B(u,"click",s[14])],a=!0)},p(g,d){d&64&&z(n,g[6])},d(g){g&&v(e),a=!1,oe(p)}}}function Zt(s){let e,t,n,i,o,l,c,u,a,p,g=s[0]&&ot(s);return{c(){e=m("div"),t=m("h3"),t.textContent="Choose an option:",n=h(),i=m("div"),o=m("button"),o.textContent="Use Camera",l=h(),c=m("button"),c.textContent="Upload Picture",u=h(),g&&g.c(),f(o,"class","option-button svelte-2q4irt"),f(c,"class","option-button svelte-2q4irt"),f(i,"class","options-buttons svelte-2q4irt"),f(e,"class","camera-options svelte-2q4irt")},m(d,S){E(d,e,S),r(e,t),r(e,n),r(e,i),r(i,o),r(i,l),r(i,c),r(i,u),g&&g.m(i,null),a||(p=[B(o,"click",s[11]),B(c,"click",s[12])],a=!0)},p(d,S){d[0]?g?g.p(d,S):(g=ot(d),g.c(),g.m(i,null)):g&&(g.d(1),g=null)},d(d){d&&v(e),g&&g.d(),a=!1,oe(p)}}}function nt(s){let e,t,n;return{c(){e=m("video"),t=h(),n=m("canvas"),e.autoplay=!0,e.playsInline=!0,f(e,"class","svelte-2q4irt"),Ye(n,"display","none")},m(i,o){E(i,e,o),s[15](e),E(i,t,o),E(i,n,o),s[16](n)},p:D,d(i){i&&(v(e),v(t),v(n)),s[15](null),s[16](null)}}}function it(s){let e,t,n;return{c(){e=m("button"),e.textContent="Take Photo",f(e,"class","capture-button svelte-2q4irt")},m(i,o){E(i,e,o),t||(n=B(e,"click",s[8]),t=!0)},p:D,d(i){i&&v(e),t=!1,n()}}}function ot(s){let e,t,n;return{c(){e=m("button"),e.textContent="Skip Picture",f(e,"class","option-button skip-button svelte-2q4irt")},m(i,o){E(i,e,o),t||(n=B(e,"click",s[10]),t=!0)},p:D,d(i){i&&v(e),t=!1,n()}}}function $t(s){let e;function t(o,l){return o[1]?Zt:o[6]?Xt:Qt}let n=t(s),i=n(s);return{c(){e=m("div"),i.c(),f(e,"class","camera-container svelte-2q4irt")},m(o,l){E(o,e,l),i.m(e,null)},p(o,[l]){n===(n=t(o))&&i?i.p(o,l):(i.d(1),i=n(o),i&&(i.c(),i.m(e,null)))},i:D,o:D,d(o){o&&v(e),i.d()}}}function xt(s,e,t){let{autoStart:n=!1}=e,{optional:i=!1}=e,o=!0,l,c,u,a=!1,p="";const g=pe.getInstance().getCameraService(),d=ke();De(async()=>{n&&await S()}),yt(()=>{_()});async function S(){try{t(6,p=""),await g.initialize(l),t(5,a=!0)}catch(C){t(6,p="Could not access camera. Please ensure you have granted camera permissions."),console.error(C)}}function _(){a&&(g.stopCamera(),t(5,a=!1))}function b(){if(a)try{const C=g.takePicture(c);d("capture",{imageData:C})}catch(C){console.error("Error taking picture:",C),t(6,p="Failed to capture image")}}function y(C){var N;const K=C.target,w=(N=K.files)==null?void 0:N[0];if(!w)return;if(!w.type.startsWith("image/")){t(6,p="Please select an image file");return}const A=new FileReader;A.onload=$=>{var H;const V=new Image;V.onload=()=>{t(3,c.width=V.width,c),t(3,c.height=V.height,c);const R=c.getContext("2d");R==null||R.drawImage(V,0,0);const W=c.toDataURL("image/jpeg");d("capture",{imageData:W})},V.src=(H=$.target)==null?void 0:H.result},A.readAsDataURL(w),K.value=""}function G(){d("skip")}function k(){t(1,o=!1),S()}function O(){t(1,o=!1),t(5,a=!1)}const F=()=>t(1,o=!0);function L(C){Ce[C?"unshift":"push"](()=>{l=C,t(2,l)})}function T(C){Ce[C?"unshift":"push"](()=>{c=C,t(3,c)})}function U(C){Ce[C?"unshift":"push"](()=>{u=C,t(4,u)})}const M=()=>t(1,o=!0);return s.$$set=C=>{"autoStart"in C&&t(13,n=C.autoStart),"optional"in C&&t(0,i=C.optional)},[i,o,l,c,u,a,p,S,b,y,G,k,O,n,F,L,T,U,M]}class wt extends de{constructor(e){super(),fe(this,e,xt,$t,ue,{autoStart:13,optional:0})}}function lt(s){let e,t;return{c(){e=m("div"),t=I(s[4]),f(e,"class","error-message svelte-jugga6")},m(n,i){E(n,e,i),r(e,t)},p(n,i){i&16&&z(t,n[4])},d(n){n&&v(e)}}}function es(s){let e,t;return e=new wt({props:{optional:!0}}),e.$on("capture",s[5]),e.$on("skip",s[6]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p:D,i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function ts(s){let e,t,n,i,o,l,c,u;return{c(){e=m("div"),t=m("img"),i=h(),o=m("button"),l=I("Retake"),me(t.src,n=s[2])||f(t,"src",n),f(t,"alt","Before"),f(t,"class","svelte-jugga6"),f(o,"class","retake-button svelte-jugga6"),o.disabled=s[3],f(e,"class","picture-preview svelte-jugga6")},m(a,p){E(a,e,p),r(e,t),r(e,i),r(e,o),r(o,l),c||(u=B(o,"click",s[10]),c=!0)},p(a,p){p&4&&!me(t.src,n=a[2])&&f(t,"src",n),p&8&&(o.disabled=a[3])},i:D,o:D,d(a){a&&v(e),c=!1,u()}}}function ss(s){let e,t,n,i,o,l,c,u,a,p,g,d,S,_,b,y,G,k,O,F,L,T,U=s[3]?"Starting...":"Start Session",M,C,K,w,A,N=s[4]&&lt(s);const $=[ts,es],V=[];function H(R,W){return R[2]?0:1}return k=H(s),O=V[k]=$[k](s),{c(){e=m("div"),t=m("h1"),t.textContent="Start New Session",n=h(),N&&N.c(),i=h(),o=m("div"),l=m("label"),l.textContent="Session Title",c=h(),u=m("input"),a=h(),p=m("div"),g=m("label"),g.textContent="Goal Time (minutes)",d=h(),S=m("input"),_=h(),b=m("div"),y=m("label"),y.textContent="Before Picture (Optional)",G=h(),O.c(),F=h(),L=m("div"),T=m("button"),M=I(U),f(t,"class","svelte-jugga6"),f(l,"for","title"),f(l,"class","svelte-jugga6"),f(u,"type","text"),f(u,"id","title"),f(u,"placeholder","Enter session title"),u.disabled=s[3],f(u,"class","svelte-jugga6"),f(o,"class","form-group svelte-jugga6"),f(g,"for","goalTime"),f(g,"class","svelte-jugga6"),f(S,"type","number"),f(S,"id","goalTime"),f(S,"min","1"),f(S,"max","240"),S.disabled=s[3],f(S,"class","svelte-jugga6"),f(p,"class","form-group svelte-jugga6"),f(y,"class","svelte-jugga6"),f(b,"class","form-group svelte-jugga6"),f(T,"class","start-button svelte-jugga6"),T.disabled=C=s[3]||!s[0],f(L,"class","form-actions svelte-jugga6"),f(e,"class","start-session-page svelte-jugga6")},m(R,W){E(R,e,W),r(e,t),r(e,n),N&&N.m(e,null),r(e,i),r(e,o),r(o,l),r(o,c),r(o,u),Ee(u,s[0]),r(e,a),r(e,p),r(p,g),r(p,d),r(p,S),Ee(S,s[1]),r(e,_),r(e,b),r(b,y),r(b,G),V[k].m(b,null),r(e,F),r(e,L),r(L,T),r(T,M),K=!0,w||(A=[B(u,"input",s[8]),B(S,"input",s[9]),B(T,"click",s[7])],w=!0)},p(R,[W]){R[4]?N?N.p(R,W):(N=lt(R),N.c(),N.m(e,i)):N&&(N.d(1),N=null),(!K||W&8)&&(u.disabled=R[3]),W&1&&u.value!==R[0]&&Ee(u,R[0]),(!K||W&8)&&(S.disabled=R[3]),W&2&&bt(S.value)!==R[1]&&Ee(S,R[1]);let q=k;k=H(R),k===q?V[k].p(R,W):(Re(),Q(V[q],1,1,()=>{V[q]=null}),Ne(),O=V[k],O?O.p(R,W):(O=V[k]=$[k](R),O.c()),J(O,1),O.m(b,null)),(!K||W&8)&&U!==(U=R[3]?"Starting...":"Start Session")&&z(M,U),(!K||W&9&&C!==(C=R[3]||!R[0]))&&(T.disabled=C)},i(R){K||(J(O),K=!0)},o(R){Q(O),K=!1},d(R){R&&v(e),N&&N.d(),V[k].d(),w=!1,oe(A)}}}function ns(s,e,t){const n=pe.getInstance().getSessionService(),i=ke();let o="",l=30,c="",u=!1,a="";function p(y){t(2,c=y.detail.imageData)}function g(){t(2,c="")}async function d(){if(!o.trim()){t(4,a="Please enter a session title");return}if(l<=0){t(4,a="Goal time must be greater than zero");return}t(4,a=""),t(3,u=!0);try{const y=await n.startSession(o,l,c);i("sessionStarted",{sessionId:y.sessionId})}catch(y){console.error("Error starting session:",y),t(4,a=y instanceof Error?y.message:"Failed to start session")}finally{t(3,u=!1)}}function S(){o=this.value,t(0,o)}function _(){l=bt(this.value),t(1,l)}return[o,l,c,u,a,p,g,d,S,_,()=>t(2,c="")]}class is extends de{constructor(e){super(),fe(this,e,ns,ss,ue,{})}}function os(s){let e,t,n,i,o,l,c,u,a,p,g;return{c(){e=m("div"),t=m("div"),n=I(s[1]),i=h(),o=m("div"),l=m("div"),c=h(),u=m("div"),a=I("Goal: "),p=I(s[0]),g=I(" minutes"),f(t,"class","timer svelte-1jrk36o"),f(l,"class","progress-bar svelte-1jrk36o"),Ye(l,"width",s[2]+"%"),f(o,"class","progress-container svelte-1jrk36o"),f(u,"class","goal-time svelte-1jrk36o"),f(e,"class","timer-container svelte-1jrk36o")},m(d,S){E(d,e,S),r(e,t),r(t,n),r(e,i),r(e,o),r(o,l),r(e,c),r(e,u),r(u,a),r(u,p),r(u,g)},p(d,[S]){S&2&&z(n,d[1]),S&4&&Ye(l,"width",d[2]+"%"),S&1&&z(p,d[0])},i:D,o:D,d(d){d&&v(e)}}}function ls(s,e,t){let{startTime:n}=e,{endTime:i=void 0}=e,{status:o}=e,{goalTimeMinutes:l}=e,c="00:00:00",u=0,a;function p(){if(o===j.ENDED&&i){const d=i.getTime()-n.getTime();g(d)}else if(o!==j.ENDED){const S=new Date().getTime()-n.getTime();g(S)}}function g(d){const S=Math.floor(d/36e5),_=Math.floor(d%(1e3*60*60)/(1e3*60)),b=Math.floor(d%(1e3*60)/1e3);t(1,c=`${S.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}:${b.toString().padStart(2,"0")}`);const y=l*60*1e3;t(2,u=Math.min(100,d/y*100))}return De(()=>{p(),o!==j.ENDED&&t(6,a=setInterval(p,1e3))}),yt(()=>{a&&clearInterval(a)}),s.$$set=d=>{"startTime"in d&&t(3,n=d.startTime),"endTime"in d&&t(4,i=d.endTime),"status"in d&&t(5,o=d.status),"goalTimeMinutes"in d&&t(0,l=d.goalTimeMinutes)},s.$$.update=()=>{s.$$.dirty&96&&(o===j.PAUSED&&a?(clearInterval(a),t(6,a=0)):o===j.IN_PROGRESS&&!a?(p(),t(6,a=setInterval(p,1e3))):o===j.ENDED&&a&&(clearInterval(a),t(6,a=0),p()))},[l,c,u,n,i,o,a]}class rs extends de{constructor(e){super(),fe(this,e,ls,os,ue,{startTime:3,endTime:4,status:5,goalTimeMinutes:0})}}function rt(s,e,t){const n=s.slice();return n[1]=e[t],n}function as(s){let e,t=ze(s[0]),n=[];for(let i=0;i<t.length;i+=1)n[i]=at(rt(s,t,i));return{c(){e=m("ul");for(let i=0;i<n.length;i+=1)n[i].c();f(e,"class","svelte-1fnefx6")},m(i,o){E(i,e,o);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(i,o){if(o&1){t=ze(i[0]);let l;for(l=0;l<t.length;l+=1){const c=rt(i,t,l);n[l]?n[l].p(c,o):(n[l]=at(c),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(i){i&&v(e),vt(n,i)}}}function cs(s){let e;return{c(){e=m("p"),e.textContent="No comments yet",f(e,"class","no-comments svelte-1fnefx6")},m(t,n){E(t,e,n)},p:D,d(t){t&&v(e)}}}function at(s){let e,t,n=ct(s[1].timestamp)+"",i,o,l,c=s[1].text+"",u,a;return{c(){e=m("li"),t=m("div"),i=I(n),o=h(),l=m("div"),u=I(c),a=h(),f(t,"class","comment-time svelte-1fnefx6"),f(l,"class","comment-text svelte-1fnefx6"),f(e,"class","comment-item svelte-1fnefx6")},m(p,g){E(p,e,g),r(e,t),r(t,i),r(e,o),r(e,l),r(l,u),r(e,a)},p(p,g){g&1&&n!==(n=ct(p[1].timestamp)+"")&&z(i,n),g&1&&c!==(c=p[1].text+"")&&z(u,c)},d(p){p&&v(e)}}}function us(s){let e,t,n;function i(c,u){return c[0].length===0?cs:as}let o=i(s),l=o(s);return{c(){e=m("div"),t=m("h3"),t.textContent="Comments",n=h(),l.c(),f(t,"class","svelte-1fnefx6"),f(e,"class","comment-list svelte-1fnefx6")},m(c,u){E(c,e,u),r(e,t),r(e,n),l.m(e,null)},p(c,[u]){o===(o=i(c))&&l?l.p(c,u):(l.d(1),l=o(c),l&&(l.c(),l.m(e,null)))},i:D,o:D,d(c){c&&v(e),l.d()}}}function ct(s){return s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function fs(s,e,t){let{comments:n=[]}=e;return s.$$set=i=>{"comments"in i&&t(0,n=i.comments)},[n]}class kt extends de{constructor(e){super(),fe(this,e,fs,us,ue,{comments:0})}}function ds(s){let e,t=s[0].title+"",n,i,o,l,c,u,a=s[0].sessionStatus===j.PAUSED?"Resume":"Pause",p,g,d,S,_,b,y,G,k,O,F,L,T,U,M,C,K;return o=new rs({props:{startTime:s[0].startTime,status:s[0].sessionStatus,goalTimeMinutes:s[0].goalTime}}),U=new kt({props:{comments:s[0].comments}}),{c(){e=m("h1"),n=I(t),i=h(),ae(o.$$.fragment),l=h(),c=m("div"),u=m("button"),p=I(a),g=h(),d=m("button"),d.textContent="End Session",S=h(),_=m("div"),b=m("div"),y=m("textarea"),k=h(),O=m("button"),F=I("Add"),T=h(),ae(U.$$.fragment),f(e,"class","svelte-1tw785t"),f(u,"class","pause-button svelte-1tw785t"),f(d,"class","end-button svelte-1tw785t"),f(c,"class","session-controls svelte-1tw785t"),f(y,"placeholder","Add a comment..."),y.disabled=G=s[4]||s[0].sessionStatus===j.PAUSED,f(y,"class","svelte-1tw785t"),O.disabled=L=!s[1].trim()||s[4]||s[0].sessionStatus===j.PAUSED,f(O,"class","svelte-1tw785t"),f(b,"class","add-comment svelte-1tw785t"),f(_,"class","comment-section svelte-1tw785t")},m(w,A){E(w,e,A),r(e,n),E(w,i,A),ne(o,w,A),E(w,l,A),E(w,c,A),r(c,u),r(u,p),r(c,g),r(c,d),E(w,S,A),E(w,_,A),r(_,b),r(b,y),Ee(y,s[1]),r(b,k),r(b,O),r(O,F),r(_,T),ne(U,_,null),M=!0,C||(K=[B(u,"click",s[7]),B(d,"click",s[8]),B(y,"input",s[10]),B(O,"click",s[6])],C=!0)},p(w,A){(!M||A&1)&&t!==(t=w[0].title+"")&&z(n,t);const N={};A&1&&(N.startTime=w[0].startTime),A&1&&(N.status=w[0].sessionStatus),A&1&&(N.goalTimeMinutes=w[0].goalTime),o.$set(N),(!M||A&1)&&a!==(a=w[0].sessionStatus===j.PAUSED?"Resume":"Pause")&&z(p,a),(!M||A&17&&G!==(G=w[4]||w[0].sessionStatus===j.PAUSED))&&(y.disabled=G),A&2&&Ee(y,w[1]),(!M||A&19&&L!==(L=!w[1].trim()||w[4]||w[0].sessionStatus===j.PAUSED))&&(O.disabled=L);const $={};A&1&&($.comments=w[0].comments),U.$set($)},i(w){M||(J(o.$$.fragment,w),J(U.$$.fragment,w),M=!0)},o(w){Q(o.$$.fragment,w),Q(U.$$.fragment,w),M=!1},d(w){w&&(v(e),v(i),v(l),v(c),v(S),v(_)),ie(o,w),ie(U),C=!1,oe(K)}}}function ms(s){let e,t,n,i,o,l,c;return{c(){e=m("div"),t=m("p"),n=I(s[3]),i=h(),o=m("button"),o.textContent="Retry",f(e,"class","error-message svelte-1tw785t")},m(u,a){E(u,e,a),r(e,t),r(t,n),r(e,i),r(e,o),l||(c=B(o,"click",s[5]),l=!0)},p(u,a){a&8&&z(n,u[3])},i:D,o:D,d(u){u&&v(e),l=!1,c()}}}function ps(s){let e;return{c(){e=m("div"),e.textContent="Loading session...",f(e,"class","loading svelte-1tw785t")},m(t,n){E(t,e,n)},p:D,i:D,o:D,d(t){t&&v(e)}}}function gs(s){let e,t,n,i;const o=[ps,ms,ds],l=[];function c(u,a){return u[2]?0:u[3]?1:u[0]?2:-1}return~(t=c(s))&&(n=l[t]=o[t](s)),{c(){e=m("div"),n&&n.c(),f(e,"class","session-in-progress svelte-1tw785t")},m(u,a){E(u,e,a),~t&&l[t].m(e,null),i=!0},p(u,[a]){let p=t;t=c(u),t===p?~t&&l[t].p(u,a):(n&&(Re(),Q(l[p],1,1,()=>{l[p]=null}),Ne()),~t?(n=l[t],n?n.p(u,a):(n=l[t]=o[t](u),n.c()),J(n,1),n.m(e,null)):n=null)},i(u){i||(J(n),i=!0)},o(u){Q(n),i=!1},d(u){u&&v(e),~t&&l[t].d()}}}function Ss(s,e,t){let{sessionId:n}=e;const i=pe.getInstance().getSessionService(),o=ke();let l=null,c="",u=!0,a="",p=!1;De(async()=>{await g()});async function g(){t(2,u=!0),t(3,a="");try{t(0,l=await i.getSessionDetails(n))}catch(y){console.error("Error loading session:",y),t(3,a=y instanceof Error?y.message:"Failed to load session")}finally{t(2,u=!1)}}async function d(){if(!(!c.trim()||!l)){t(4,p=!0);try{await i.addComment(n,c),t(1,c=""),await g()}catch(y){console.error("Error adding comment:",y),t(3,a=y instanceof Error?y.message:"Failed to add comment")}finally{t(4,p=!1)}}}async function S(){if(l)try{l.sessionStatus===j.IN_PROGRESS?t(0,l=await i.pauseSession(n)):l.sessionStatus===j.PAUSED&&t(0,l=await i.resumeSession(n))}catch(y){console.error("Error toggling pause:",y),t(3,a=y instanceof Error?y.message:"Failed to update session")}}function _(){o("endSession",{sessionId:n})}function b(){c=this.value,t(1,c)}return s.$$set=y=>{"sessionId"in y&&t(9,n=y.sessionId)},[l,c,u,a,p,g,d,S,_,n,b]}class _s extends de{constructor(e){super(),fe(this,e,Ss,gs,ue,{sessionId:9})}}function ut(s){let e,t;return{c(){e=m("div"),t=I(s[2]),f(e,"class","error-message svelte-1wi38ju")},m(n,i){E(n,e,i),r(e,t)},p(n,i){i&4&&z(t,n[2])},d(n){n&&v(e)}}}function hs(s){let e,t;return e=new wt({props:{optional:!0}}),e.$on("capture",s[3]),e.$on("skip",s[4]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p:D,i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function vs(s){let e,t,n,i,o,l,c,u;return{c(){e=m("div"),t=m("img"),i=h(),o=m("button"),l=I("Retake"),me(t.src,n=s[0])||f(t,"src",n),f(t,"alt","After"),f(t,"class","svelte-1wi38ju"),f(o,"class","retake-button svelte-1wi38ju"),o.disabled=s[1],f(e,"class","picture-preview svelte-1wi38ju")},m(a,p){E(a,e,p),r(e,t),r(e,i),r(e,o),r(o,l),c||(u=B(o,"click",s[7]),c=!0)},p(a,p){p&1&&!me(t.src,n=a[0])&&f(t,"src",n),p&2&&(o.disabled=a[1])},i:D,o:D,d(a){a&&v(e),c=!1,u()}}}function bs(s){let e,t,n,i,o,l,c,u,a,p,g,d,S=s[1]?"Completing...":"Complete Session",_,b,y,G,k=s[2]&&ut(s);const O=[vs,hs],F=[];function L(T,U){return T[0]?0:1}return u=L(s),a=F[u]=O[u](s),{c(){e=m("div"),t=m("h1"),t.textContent="Complete Your Session",n=h(),k&&k.c(),i=h(),o=m("div"),l=m("label"),l.textContent="After Picture (Optional)",c=h(),a.c(),p=h(),g=m("div"),d=m("button"),_=I(S),f(t,"class","svelte-1wi38ju"),f(l,"class","svelte-1wi38ju"),f(o,"class","form-group svelte-1wi38ju"),f(d,"class","complete-button svelte-1wi38ju"),d.disabled=s[1],f(g,"class","form-actions svelte-1wi38ju"),f(e,"class","end-session-page svelte-1wi38ju")},m(T,U){E(T,e,U),r(e,t),r(e,n),k&&k.m(e,null),r(e,i),r(e,o),r(o,l),r(o,c),F[u].m(o,null),r(e,p),r(e,g),r(g,d),r(d,_),b=!0,y||(G=B(d,"click",s[5]),y=!0)},p(T,[U]){T[2]?k?k.p(T,U):(k=ut(T),k.c(),k.m(e,i)):k&&(k.d(1),k=null);let M=u;u=L(T),u===M?F[u].p(T,U):(Re(),Q(F[M],1,1,()=>{F[M]=null}),Ne(),a=F[u],a?a.p(T,U):(a=F[u]=O[u](T),a.c()),J(a,1),a.m(o,null)),(!b||U&2)&&S!==(S=T[1]?"Completing...":"Complete Session")&&z(_,S),(!b||U&2)&&(d.disabled=T[1])},i(T){b||(J(a),b=!0)},o(T){Q(a),b=!1},d(T){T&&v(e),k&&k.d(),F[u].d(),y=!1,G()}}}function ys(s,e,t){let{sessionId:n}=e;const i=pe.getInstance().getSessionService(),o=ke();let l="",c=!1,u="";function a(S){t(0,l=S.detail.imageData)}function p(){t(0,l="")}async function g(){t(2,u=""),t(1,c=!0);try{await i.endSession(n,l),o("sessionEnded",{sessionId:n})}catch(S){console.error("Error ending session:",S),t(2,u=S instanceof Error?S.message:"Failed to end session")}finally{t(1,c=!1)}}const d=()=>t(0,l="");return s.$$set=S=>{"sessionId"in S&&t(6,n=S.sessionId)},[l,c,u,a,p,g,n,d]}class Es extends de{constructor(e){super(),fe(this,e,ys,bs,ue,{sessionId:6})}}function ft(s,e,t){const n=s.slice();return n[11]=e[t],n}function ws(s){let e,t=ze(s[0]),n=[];for(let i=0;i<t.length;i+=1)n[i]=mt(ft(s,t,i));return{c(){e=m("div");for(let i=0;i<n.length;i+=1)n[i].c();f(e,"class","sessions-list svelte-aeyz0d")},m(i,o){E(i,e,o);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null)},p(i,o){if(o&81){t=ze(i[0]);let l;for(l=0;l<t.length;l+=1){const c=ft(i,t,l);n[l]?n[l].p(c,o):(n[l]=mt(c),n[l].c(),n[l].m(e,null))}for(;l<n.length;l+=1)n[l].d(1);n.length=t.length}},d(i){i&&v(e),vt(n,i)}}}function ks(s){let e,t,n,i,o,l;return{c(){e=m("div"),t=m("p"),t.textContent="You haven't created any sessions yet.",n=h(),i=m("button"),i.textContent="Start Your First Session",f(t,"class","svelte-aeyz0d"),f(e,"class","no-sessions svelte-aeyz0d")},m(c,u){E(c,e,u),r(e,t),r(e,n),r(e,i),o||(l=B(i,"click",s[5]),o=!0)},p:D,d(c){c&&v(e),o=!1,l()}}}function Is(s){let e,t,n,i,o,l,c;return{c(){e=m("div"),t=m("p"),n=I(s[2]),i=h(),o=m("button"),o.textContent="Retry",f(e,"class","error-message svelte-aeyz0d")},m(u,a){E(u,e,a),r(e,t),r(t,n),r(e,i),r(e,o),l||(c=B(o,"click",s[3]),l=!0)},p(u,a){a&4&&z(n,u[2])},d(u){u&&v(e),l=!1,c()}}}function Ts(s){let e;return{c(){e=m("div"),e.textContent="Loading sessions...",f(e,"class","loading svelte-aeyz0d")},m(t,n){E(t,e,n)},p:D,d(t){t&&v(e)}}}function dt(s){let e,t,n=Be(s[11].endTime)+"",i;return{c(){e=m("br"),t=I("Ended: "),i=I(n)},m(o,l){E(o,e,l),E(o,t,l),E(o,i,l)},p(o,l){l&1&&n!==(n=Be(o[11].endTime)+"")&&z(i,n)},d(o){o&&(v(e),v(t),v(i))}}}function mt(s){let e,t,n,i=s[11].title+"",o,l,c,u,a=pt(s[11].startTime)+"",p,g,d,S,_,b,y,G=Be(s[11].startTime)+"",k,O,F,L,T,U=s[11].goalTime+"",M,C,K,w,A=s[11].comments.length+"",N,$,V,H,R;function W(...x){return s[7](s[11],...x)}let q=s[11].endTime&&dt(s);function ce(){return s[8](s[11])}return{c(){e=m("div"),t=m("div"),n=m("h3"),o=I(i),l=h(),c=m("div"),u=m("span"),p=I(a),g=h(),d=m("button"),d.textContent="×",S=h(),_=m("div"),b=m("div"),y=I("Started: "),k=I(G),O=h(),q&&q.c(),F=h(),L=m("div"),T=I("Goal: "),M=I(U),C=I(" minutes"),K=h(),w=m("div"),N=I(A),$=I(" comments"),V=h(),f(n,"class","svelte-aeyz0d"),f(u,"class","session-date svelte-aeyz0d"),f(d,"class","delete-button svelte-aeyz0d"),f(d,"title","Delete session"),f(c,"class","session-actions svelte-aeyz0d"),f(t,"class","session-header svelte-aeyz0d"),f(b,"class","session-time svelte-aeyz0d"),f(L,"class","session-goal svelte-aeyz0d"),f(w,"class","session-comments svelte-aeyz0d"),f(_,"class","session-details svelte-aeyz0d"),f(e,"class","session-card svelte-aeyz0d")},m(x,te){E(x,e,te),r(e,t),r(t,n),r(n,o),r(t,l),r(t,c),r(c,u),r(u,p),r(c,g),r(c,d),r(e,S),r(e,_),r(_,b),r(b,y),r(b,k),r(b,O),q&&q.m(b,null),r(_,F),r(_,L),r(L,T),r(L,M),r(L,C),r(_,K),r(_,w),r(w,N),r(w,$),r(e,V),H||(R=[B(d,"click",W),B(_,"click",ce)],H=!0)},p(x,te){s=x,te&1&&i!==(i=s[11].title+"")&&z(o,i),te&1&&a!==(a=pt(s[11].startTime)+"")&&z(p,a),te&1&&G!==(G=Be(s[11].startTime)+"")&&z(k,G),s[11].endTime?q?q.p(s,te):(q=dt(s),q.c(),q.m(b,null)):q&&(q.d(1),q=null),te&1&&U!==(U=s[11].goalTime+"")&&z(M,U),te&1&&A!==(A=s[11].comments.length+"")&&z(N,A)},d(x){x&&v(e),q&&q.d(),H=!1,oe(R)}}}function Cs(s){let e,t,n,i,o,l,c,u;function a(d,S){return d[1]?Ts:d[2]?Is:d[0].length===0?ks:ws}let p=a(s),g=p(s);return{c(){e=m("div"),t=m("h1"),t.textContent="Your Sessions",n=h(),i=m("div"),o=m("button"),o.textContent="Start New Session",l=h(),g.c(),f(t,"class","svelte-aeyz0d"),f(o,"class","new-session-button svelte-aeyz0d"),f(i,"class","actions svelte-aeyz0d"),f(e,"class","past-sessions-page svelte-aeyz0d")},m(d,S){E(d,e,S),r(e,t),r(e,n),r(e,i),r(i,o),r(e,l),g.m(e,null),c||(u=B(o,"click",s[5]),c=!0)},p(d,[S]){p===(p=a(d))&&g?g.p(d,S):(g.d(1),g=p(d),g&&(g.c(),g.m(e,null)))},i:D,o:D,d(d){d&&v(e),g.d(),c=!1,u()}}}function pt(s){return s.toLocaleDateString()}function Be(s){return s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function Ps(s,e,t){const n=pe.getInstance().getSessionService(),i=ke();let o=[],l=!0,c="";De(async()=>{await u()});async function u(){t(1,l=!0),t(2,c="");try{t(0,o=await n.getAllSessions()),o.sort((_,b)=>b.startTime.getTime()-_.startTime.getTime())}catch(_){console.error("Error loading sessions:",_),t(2,c=_ instanceof Error?_.message:"Failed to load sessions")}finally{t(1,l=!1)}}function a(_){i("viewSession",{sessionId:_})}function p(){i("startNewSession")}async function g(_,b){if(_.stopPropagation(),confirm("Are you sure you want to delete this session? This action cannot be undone."))try{await n.deleteSession(b),await u()}catch(y){console.error("Error deleting session:",y),t(2,c=y instanceof Error?y.message:"Failed to delete session")}}return[o,l,c,u,a,p,g,(_,b)=>g(b,_.sessionId),_=>a(_.sessionId)]}class Ds extends de{constructor(e){super(),fe(this,e,Ps,Cs,ue,{})}}function Rs(s){let e,t=s[0].title+"",n,i,o,l,c,u,a,p=Ge(s[0].startTime)+"",g,d,S,_,b,y,G,k=St(s[0].startTime,s[0].endTime)+"",O,F,L,T,U,M,C=s[0].goalTime+"",K,w,A,N,$,V,H,R=s[0].sessionStatus.replace("_"," ")+"",W,q,ce,x,te,We,Qe,ge,Oe,Xe,Fe,Ie,Se,se,ee=s[0].endTime&&gt(s);function Ze(P,Y){return P[1]?As:Us}let Ue=Ze(s),le=Ue(s);function $e(P,Y){return P[2]?Ls:js}let Ae=$e(s),re=Ae(s);return Se=new kt({props:{comments:s[0].comments}}),{c(){e=m("h1"),n=I(t),i=h(),o=m("div"),l=m("div"),c=m("span"),c.textContent="Started:",u=h(),a=m("span"),g=I(p),d=h(),ee&&ee.c(),S=I(`
      }
      
      `),_=m("div"),b=m("span"),b.textContent="Duration:",y=h(),G=m("span"),O=I(k),F=h(),L=m("div"),T=m("span"),T.textContent="Goal Time:",U=h(),M=m("span"),K=I(C),w=I(" minutes"),A=h(),N=m("div"),$=m("span"),$.textContent="Status:",V=h(),H=m("span"),W=I(R),q=h(),ce=m("div"),x=m("div"),te=m("h3"),te.textContent="Before",We=h(),le.c(),Qe=h(),ge=m("div"),Oe=m("h3"),Oe.textContent="After",Xe=h(),re.c(),Fe=h(),Ie=m("div"),ae(Se.$$.fragment),f(e,"class","svelte-1i39fgl"),f(c,"class","label svelte-1i39fgl"),f(a,"class","value"),f(l,"class","info-item svelte-1i39fgl"),f(b,"class","label svelte-1i39fgl"),f(G,"class","value"),f(_,"class","info-item svelte-1i39fgl"),f(T,"class","label svelte-1i39fgl"),f(M,"class","value"),f(L,"class","info-item svelte-1i39fgl"),f($,"class","label svelte-1i39fgl"),f(H,"class","value status-badge svelte-1i39fgl"),ve(H,"in-progress",s[0].sessionStatus===j.IN_PROGRESS),ve(H,"paused",s[0].sessionStatus===j.PAUSED),ve(H,"ended",s[0].sessionStatus===j.ENDED),f(N,"class","info-item svelte-1i39fgl"),f(o,"class","session-info svelte-1i39fgl"),f(te,"class","svelte-1i39fgl"),f(x,"class","picture-box svelte-1i39fgl"),f(Oe,"class","svelte-1i39fgl"),f(ge,"class","picture-box svelte-1i39fgl"),f(ce,"class","pictures-container svelte-1i39fgl"),f(Ie,"class","comments-container svelte-1i39fgl")},m(P,Y){E(P,e,Y),r(e,n),E(P,i,Y),E(P,o,Y),r(o,l),r(l,c),r(l,u),r(l,a),r(a,g),r(o,d),ee&&ee.m(o,null),r(o,S),r(o,_),r(_,b),r(_,y),r(_,G),r(G,O),r(o,F),r(o,L),r(L,T),r(L,U),r(L,M),r(M,K),r(M,w),r(o,A),r(o,N),r(N,$),r(N,V),r(N,H),r(H,W),E(P,q,Y),E(P,ce,Y),r(ce,x),r(x,te),r(x,We),le.m(x,null),r(ce,Qe),r(ce,ge),r(ge,Oe),r(ge,Xe),re.m(ge,null),E(P,Fe,Y),E(P,Ie,Y),ne(Se,Ie,null),se=!0},p(P,Y){(!se||Y&1)&&t!==(t=P[0].title+"")&&z(n,t),(!se||Y&1)&&p!==(p=Ge(P[0].startTime)+"")&&z(g,p),P[0].endTime?ee?ee.p(P,Y):(ee=gt(P),ee.c(),ee.m(o,S)):ee&&(ee.d(1),ee=null),(!se||Y&1)&&k!==(k=St(P[0].startTime,P[0].endTime)+"")&&z(O,k),(!se||Y&1)&&C!==(C=P[0].goalTime+"")&&z(K,C),(!se||Y&1)&&R!==(R=P[0].sessionStatus.replace("_"," ")+"")&&z(W,R),(!se||Y&1)&&ve(H,"in-progress",P[0].sessionStatus===j.IN_PROGRESS),(!se||Y&1)&&ve(H,"paused",P[0].sessionStatus===j.PAUSED),(!se||Y&1)&&ve(H,"ended",P[0].sessionStatus===j.ENDED),Ue===(Ue=Ze(P))&&le?le.p(P,Y):(le.d(1),le=Ue(P),le&&(le.c(),le.m(x,null))),Ae===(Ae=$e(P))&&re?re.p(P,Y):(re.d(1),re=Ae(P),re&&(re.c(),re.m(ge,null)));const xe={};Y&1&&(xe.comments=P[0].comments),Se.$set(xe)},i(P){se||(J(Se.$$.fragment,P),se=!0)},o(P){Q(Se.$$.fragment,P),se=!1},d(P){P&&(v(e),v(i),v(o),v(q),v(ce),v(Fe),v(Ie)),ee&&ee.d(),le.d(),re.d(),ie(Se)}}}function Ns(s){let e,t,n,i,o,l,c;return{c(){e=m("div"),t=m("p"),n=I(s[4]),i=h(),o=m("button"),o.textContent="Retry",f(e,"class","error-message svelte-1i39fgl")},m(u,a){E(u,e,a),r(e,t),r(t,n),r(e,i),r(e,o),l||(c=B(o,"click",s[5]),l=!0)},p(u,a){a&16&&z(n,u[4])},i:D,o:D,d(u){u&&v(e),l=!1,c()}}}function Os(s){let e;return{c(){e=m("div"),e.textContent="Loading session details...",f(e,"class","loading svelte-1i39fgl")},m(t,n){E(t,e,n)},p:D,i:D,o:D,d(t){t&&v(e)}}}function gt(s){let e,t,n,i,o=Ge(s[0].endTime)+"",l;return{c(){e=m("div"),t=m("span"),t.textContent="Ended:",n=h(),i=m("span"),l=I(o),f(t,"class","label svelte-1i39fgl"),f(i,"class","value"),f(e,"class","info-item svelte-1i39fgl")},m(c,u){E(c,e,u),r(e,t),r(e,n),r(e,i),r(i,l)},p(c,u){u&1&&o!==(o=Ge(c[0].endTime)+"")&&z(l,o)},d(c){c&&v(e)}}}function Us(s){let e;return{c(){e=m("div"),e.textContent="No before picture available",f(e,"class","no-picture svelte-1i39fgl")},m(t,n){E(t,e,n)},p:D,d(t){t&&v(e)}}}function As(s){let e,t;return{c(){e=m("img"),me(e.src,t=s[1].pictureData)||f(e,"src",t),f(e,"alt","Before"),f(e,"class","svelte-1i39fgl")},m(n,i){E(n,e,i)},p(n,i){i&2&&!me(e.src,t=n[1].pictureData)&&f(e,"src",t)},d(n){n&&v(e)}}}function js(s){let e;return{c(){e=m("div"),e.textContent="No after picture available",f(e,"class","no-picture svelte-1i39fgl")},m(t,n){E(t,e,n)},p:D,d(t){t&&v(e)}}}function Ls(s){let e,t;return{c(){e=m("img"),me(e.src,t=s[2].pictureData)||f(e,"src",t),f(e,"alt","After"),f(e,"class","svelte-1i39fgl")},m(n,i){E(n,e,i)},p(n,i){i&4&&!me(e.src,t=n[2].pictureData)&&f(e,"src",t)},d(n){n&&v(e)}}}function Ms(s){let e,t,n,i,o,l,c,u;const a=[Os,Ns,Rs],p=[];function g(d,S){return d[3]?0:d[4]?1:d[0]?2:-1}return~(i=g(s))&&(o=p[i]=a[i](s)),{c(){e=m("div"),t=m("button"),t.textContent="← Back to Sessions",n=h(),o&&o.c(),f(t,"class","back-button svelte-1i39fgl"),f(e,"class","session-detail-page svelte-1i39fgl")},m(d,S){E(d,e,S),r(e,t),r(e,n),~i&&p[i].m(e,null),l=!0,c||(u=B(t,"click",s[6]),c=!0)},p(d,[S]){let _=i;i=g(d),i===_?~i&&p[i].p(d,S):(o&&(Re(),Q(p[_],1,1,()=>{p[_]=null}),Ne()),~i?(o=p[i],o?o.p(d,S):(o=p[i]=a[i](d),o.c()),J(o,1),o.m(e,null)):o=null)},i(d){l||(J(o),l=!0)},o(d){Q(o),l=!1},d(d){d&&v(e),~i&&p[i].d(),c=!1,u()}}}function Ge(s){return s.toLocaleDateString()+" "+s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}function St(s,e){const n=(e||new Date).getTime()-s.getTime(),i=Math.floor(n/(1e3*60*60)),o=Math.floor(n%(1e3*60*60)/(1e3*60));return`${i}h ${o}m`}function zs(s,e,t){let{sessionId:n}=e;const i=pe.getInstance().getSessionService(),o=ke();let l=null,c=null,u=null,a=!0,p="";De(async()=>{await g()});async function g(){t(3,a=!0),t(4,p="");try{t(0,l=await i.getSessionDetails(n)),l.beforePictureId&&t(1,c=await i.getPicture(l.beforePictureId)),l.afterPictureId&&t(2,u=await i.getPicture(l.afterPictureId))}catch(S){console.error("Error loading session details:",S),t(4,p=S instanceof Error?S.message:"Failed to load session details")}finally{t(3,a=!1)}}function d(){o("back")}return s.$$set=S=>{"sessionId"in S&&t(7,n=S.sessionId)},[l,c,u,a,p,g,d,n]}class Bs extends de{constructor(e){super(),fe(this,e,zs,Ms,ue,{sessionId:7})}}function Gs(s){let e,t;return e=new Bs({props:{sessionId:s[1]}}),e.$on("back",s[6]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p(n,i){const o={};i&2&&(o.sessionId=n[1]),e.$set(o)},i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Fs(s){let e,t;return e=new Ds({}),e.$on("startNewSession",s[3]),e.$on("viewSession",s[7]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p:D,i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function qs(s){let e,t;return e=new Es({props:{sessionId:s[1]}}),e.$on("sessionEnded",s[8]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p(n,i){const o={};i&2&&(o.sessionId=n[1]),e.$set(o)},i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Ys(s){let e,t;return e=new _s({props:{sessionId:s[1]}}),e.$on("endSession",s[5]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p(n,i){const o={};i&2&&(o.sessionId=n[1]),e.$set(o)},i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Ks(s){let e,t;return e=new is({}),e.$on("sessionStarted",s[4]),{c(){ae(e.$$.fragment)},m(n,i){ne(e,n,i),t=!0},p:D,i(n){t||(J(e.$$.fragment,n),t=!0)},o(n){Q(e.$$.fragment,n),t=!1},d(n){ie(e,n)}}}function Js(s){let e,t,n,i,o;const l=[Ks,Ys,qs,Fs,Gs],c=[];function u(a,p){return a[0]===a[2].START_SESSION?0:a[0]===a[2].SESSION_IN_PROGRESS?1:a[0]===a[2].END_SESSION?2:a[0]===a[2].PAST_SESSIONS?3:a[0]===a[2].SESSION_DETAIL?4:-1}return~(n=u(s))&&(i=c[n]=l[n](s)),{c(){e=m("main"),t=m("div"),i&&i.c(),f(t,"class","app-container svelte-tmv3ia"),f(e,"class","svelte-tmv3ia")},m(a,p){E(a,e,p),r(e,t),~n&&c[n].m(t,null),o=!0},p(a,[p]){let g=n;n=u(a),n===g?~n&&c[n].p(a,p):(i&&(Re(),Q(c[g],1,1,()=>{c[g]=null}),Ne()),~n?(i=c[n],i?i.p(a,p):(i=c[n]=l[n](a),i.c()),J(i,1),i.m(t,null)):i=null)},i(a){o||(J(i),o=!0)},o(a){Q(i),o=!1},d(a){a&&v(e),~n&&c[n].d()}}}function Vs(s,e,t){var n=(d=>(d.START_SESSION="START_SESSION",d.SESSION_IN_PROGRESS="SESSION_IN_PROGRESS",d.END_SESSION="END_SESSION",d.PAST_SESSIONS="PAST_SESSIONS",d.SESSION_DETAIL="SESSION_DETAIL",d))(n||{});let i="PAST_SESSIONS",o="";function l(){t(0,i="START_SESSION"),t(1,o="")}function c(d){t(1,o=d.detail.sessionId),t(0,i="SESSION_IN_PROGRESS")}function u(d){t(1,o=d.detail.sessionId),t(0,i="END_SESSION")}function a(){t(0,i="PAST_SESSIONS"),t(1,o="")}function p(d){t(1,o=d.detail.sessionId),t(0,i="SESSION_DETAIL")}function g(){a()}return[i,o,n,l,c,u,a,p,g]}class Hs extends de{constructor(e){super(),fe(this,e,Vs,Js,ue,{})}}new Hs({target:document.getElementById("app")});
